<!doctype html>
<html>
<head>
	<meta charset="utf-8">

	<meta http-equiv="x-ua-compatible" content="ie=edge">

	<script src="../bower_components/pubsub-js/src/pubsub.js"></script>
	<script src="../vendor/rsvp.js"></script>
	<script src="../dist/web-es5.js"></script>

	<!-- (c) 2011-2018 Absolunet -->
</head>
<body>

	<script>
		pinki.message.publish('aaa.bbb.ccc', 'pubA1');

		pinki.message.subscribe('aaa', (topic, data) => {
			console.log(`sub1: ${topic}/${data}`);
		});

		pinki.message.subscribe('aaa.bbb', (topic, data) => {
			console.log(`sub2: ${topic}/${data}`);
		}, { executePrevious:false });

		pinki.message.publish('aaa.bbb.ddd', 'pubA2');

		console.log(pinki.message.list);
	</script>

	<!-- script>

	//pinki.vow.fulfill('aaa', 'fulA');
	//pinki.vow.break('aaa', 'broken');

	pinki.vow.fulfill('ccc', 'fulC');
	//pinki.vow.break('ccc', 'breakC');


	pinki.vow.when('aaa', 'bbb')
		.then(([dataA, dataB]) => {
			console.log(`aaabbb - ${dataA} - ${dataB}`);
		})
		.catch((error) => {
			console.log(`aaabbb - ${error}`);
		})
	;


	pinki.vow.when('aaa', 'bbb')
		.then(([dataA, dataB]) => {
			console.log(`aaabbb2 - ${dataA} - ${dataB}`);
		})
		.catch((error) => {
			console.log(`aaabbb2 - ${error}`);
		})
	;


	pinki.vow.when('bbb', 'ccc')
		.then(([dataB, dataC]) => {
			console.log(`bbbccc - ${dataB} - ${dataC}`);
		})
		.catch((error) => {
			console.log(`bbbccc - ${error}`);
		})
	;


	pinki.vow.when('ccc')
		.then(([dataC]) => {
			console.log(`ccc - ${dataC}`);
		})
		.catch((error) => {
			console.log(`ccc - ${error}`);
		})
	;




	//setTimeout(() => {
	//	pinki.vow.fulfill('ccc', 'fulC');
	//}, 2000);

	setTimeout(() => {
		pinki.vow.fulfill('aaa', 'fulA');
	}, 3000);

	setTimeout(() => {
		pinki.vow.fulfill('bbb', 'fulB');
	}, 4000);



	setTimeout(() => {
		pinki.vow.when('aaa', 'ccc')
			.then(([dataA, dataC]) => {
				console.log(`aaaccc - ${dataA} - ${dataC}`);
			})
			.catch((error) => {
				console.log(`aaaccc - ${error}`);
			})
		;
	}, 6000);



	</script -->

</body>
</html>
